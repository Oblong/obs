#!/bin/sh

PREFIX=/opt/oblong/g-speak4.1

set -e

if [ "$1" = "configure" ]
then
    # Make our apps available in /usr/bin via polite symlinks.
    for program in hantenna-pipeline
    do
        update-alternatives --install /usr/bin/$program \
            $program $PREFIX/bin/$program 100
    done

    # If no other oblong package has installed these configuration
    # files, install them now.
    # FIXME: how do we handle updates?
    mkdir -p /etc/oblong
    for file in screen.protein feld.protein hantenna.protein tiled-config.protein
    do
        if test -f /etc/oblong/$file
        then
            if diff -u /etc/oblong/$file $PREFIX/share/proteins/$file
            then
                echo "/etc/oblong/$file exists and is identical to $PREFIX/share/proteins/$file"
            else
                echo "/etc/oblong/$file exists and is different from $PREFIX/share/proteins/$file, leaving unchanged"
            fi
        else
            cp $PREFIX/share/proteins/$file /etc/oblong
        fi
    done
fi

echo Warning: making $PREFIX/etc world-writable
chmod 777 $PREFIX/etc

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

